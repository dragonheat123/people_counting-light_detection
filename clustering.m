clear all;

x = [153.5, 155.75970458984375, 139.5, 147.5, 194.5, 145.7220458984375, 130.0, 192.0, 140.0, 189.0, 129.82827758789062, 151.5, 148.5, 154.7439727783203, 142.5, 202.75714111328125, 145.80140686035156, 137.47216796875, 141.30262756347656, 155.83876037597656, 155.83876037597656, 156.0, 134.0, 142.6747589111328, 51.832908630371094, 49.0, 50.20646667480469, 52.0, 161.27777099609375, 174.40988159179688, 168.56532287597656, 162.5, 165.2992706298828, 151.0, 155.83876037597656, 155.83876037597656, 134.5, 146.60247802734375, 192.0, 143.56016540527344, 157.0, 151.68182373046875, 65.0, 16.5, 148.0, 148.75926208496094, 295.0, 149.5, 149.5, 149.5, 49.5, 19.5, 49.0, 126.0, 140.5, 155.5, 52.109195709228516, 137.0, 51.333431243896484, 135.5, 46.5, 188.37258911132812, 45.5, 49.5, 189.79791259765625, 48.0, 193.41014099121094, 51.0, 206.5, 53.132076263427734, 53.61731719970703, 54.414974212646484, 58.554893493652344, 53.0, 57.32532501220703, 55.0, 55.5, 149.5, 155.5, 66.5, 127.0, 155.6199951171875, 137.5, 62.5, 154.5, 146.2666778564453, 144.80130004882812, 55.5, 148.60655212402344, 137.5, 155.2757568359375, 163.5, 164.0, 55.140567779541016, 149.8378448486328, 150.5, 148.8378448486328, 54.0, 288.0, 62.5, 194.09719848632812, 149.5, 155.5, 56.01261901855469, 56.435855865478516, 62.5, 61.5854377746582, 46.75, 126.0, 45.33094787597656, 48.0, 152.462646484375, 155.5, 50.842247009277344, 194.0, 145.73655700683594, 139.0, 47.38307189941406, 192.5, 142.5, 193.5, 143.6693572998047, 147.6392364501953, 201.5, 143.5, 201.5, 138.0, 195.44444274902344, 45.090232849121094, 44.460853576660156, 45.5, 148.57313537597656, 42.70467758178711, 126.5, 152.5592498779297, 43.5, 157.31509399414062, 45.34375, 157.7847900390625, 49.0, 168.0, 147.0, 127.0, 149.5, 46.0, 46.39848709106445, 150.15664672851562, 118.5, 159.45291137695312, 141.0, 47.5, 141.86627197265625, 141.50643920898438, 195.26271057128906, 144.71755981445312, 186.5, 122.0, 139.57321166992188, 143.0, 168.1188201904297, 156.5, 138.5, 193.0, 133.0, 157.5, 151.63438415527344, 130.5, 154.0, 122.0, 159.0, 48.5, 152.5, 152.5, 133.17605590820312, 169.3851318359375, 132.0, 49.5, 149.5, 146.264892578125, 165.0, 146.43714904785156, 146.2270965576172, 44.0, 144.6584014892578, 147.62229919433594, 153.14706420898438, 155.5, 149.5, 22.0, 44.0, 41.5, 42.5, 135.65579223632812, 153.94580078125, 43.0, 43.81174850463867, 154.92420959472656, 43.26888656616211, 146.0, 43.62080383300781, 135.57093811035156, 148.0, 145.0, 142.5, 147.0, 146.0, 148.0, 135.7847900390625, 143.5, 139.5, 139.1279296875, 132.6855010986328, 136.0, 133.1079559326172, 129.5, 131.5, 132.21453857421875, 51.083290100097656, 137.5, 148.5, 52.00162887573242, 183.5, 153.4583282470703, 125.5, 185.5, 207.24647521972656, 174.5294189453125, 200.31863403320312, 163.56173706054688, 201.61563110351562, 167.3756866455078, 201.68605041503906, 131.5, 72.5, 41.5, 50.39442825317383, 177.5, 137.0, 175.0, 43.5, 172.5, 158.0, 165.5, 146.5, 150.5, 160.3427276611328, 132.5, 158.0, 141.0, 161.5, 154.1021270751953, 155.1489715576172, 145.31060791015625, 149.0, 53.49600601196289, 136.11764526367188, 164.3589630126953, 146.0, 52.0, 192.5, 142.84091186523438, 45.28533935546875, 147.0, 145.03121948242188, 142.57830810546875, 197.0, 148.0, 133.0, 193.5, 135.46969604492188, 197.0, 149.5, 162.5, 136.0, 133.5, 138.5, 144.1519012451172, 149.0, 123.0, 148.89569091796875, 51.0, 162.0, 139.5, 52.0, 193.1750030517578, 149.5, 141.9451446533203, 121.5, 155.3333282470703, 142.88075256347656, 137.5, 143.0, 128.5, 149.129638671875, 126.0, 157.0, 61.5]';


y= [128.5, 188.86138916015625, 158.5, 127.5, 217.13157653808594, 191.1198272705078, 208.0, 198.0, 164.0, 201.0, 208.10919189453125, 164.0, 202.80262756347656, 206.63803100585938, 202.0, 199.75714111328125, 199.42056274414062, 190.2130584716797, 183.82894897460938, 131.29132080078125, 131.29132080078125, 178.5, 185.0, 184.08251953125, 76.33989715576172, 76.78260803222656, 76.77362823486328, 76.5, 29.72222137451172, 21.787858963012695, 23.886934280395508, 29.0, 29.375911712646484, 112.0, 131.29132080078125, 131.29132080078125, 218.0, 182.81365966796875, 217.0, 189.9696807861328, 176.5, 112.0, 22.5, 5.5, 112.0, 112.00000762939453, 172.5, 112.0, 112.0, 112.0, 77.0, 13.5, 76.5, 211.5, 178.5, 131.0, 74.69540405273438, 178.5, 88.33641052246094, 177.0, 85.5, 69.34475708007812, 108.5, 76.5, 72.276123046875, 73.5, 56.078224182128906, 88.0, 58.5, 85.70282745361328, 80.98603057861328, 74.08259582519531, 73.00318908691406, 71.5, 76.20240020751953, 73.8515625, 66.5, 113.32882690429688, 131.0, 71.5, 8.0, 131.13999938964844, 162.5, 71.5, 174.5, 175.99691772460938, 190.85667419433594, 57.0, 175.8114776611328, 179.0, 176.86968994140625, 27.0, 26.5, 58.64234924316406, 176.29730224609375, 176.5, 175.29730224609375, 58.5, 217.0, 71.5, 58.58116149902344, 112.0, 131.0, 76.18296813964844, 71.46134948730469, 70.5, 72.97378540039062, 72.0, 8.0, 64.30364227294922, 66.6551742553711, 202.43531799316406, 131.0, 57.366310119628906, 216.5, 199.60537719726562, 165.5, 67.06459045410156, 218.0, 191.0, 216.5, 191.48802185058594, 176.56329345703125, 53.5, 176.5, 53.0, 178.5, 56.55555725097656, 64.9692153930664, 59.983097076416016, 62.0, 177.28219604492188, 53.45906448364258, 8.0, 178.77456665039062, 52.0, 180.10574340820312, 53.5, 180.15203857421875, 71.0, 180.5, 179.0, 7.599999904632568, 112.0, 66.5, 64.4697265625, 177.48712158203125, 195.0, 188.65235900878906, 158.5, 51.0, 175.156005859375, 179.4849853515625, 207.73728942871094, 198.85877990722656, 213.0, 201.5, 192.6926727294922, 188.0, 183.9147186279297, 192.5, 176.5, 59.5, 193.0, 176.5, 49.18072509765625, 191.0, 55.5, 74.5, 30.0, 72.0, 55.5, 50.5, 46.823944091796875, 28.85671043395996, 191.5, 70.0, 38.5, 186.3174591064453, 31.0, 187.55545043945312, 193.02694702148438, 52.0, 192.56150817871094, 187.32029724121094, 32.5, 131.0, 112.0, 24.0, 52.5, 53.5, 53.5, 77.44746398925781, 43.35889434814453, 52.0, 64.77635192871094, 29.89311408996582, 60.805755615234375, 21.5, 53.8006706237793, 46.39158248901367, 23.5, 53.0, 52.0, 55.5, 54.0, 52.0, 49.29087829589844, 33.0, 43.5, 44.83027648925781, 33.50843048095703, 47.0, 30.306915283203125, 44.0, 32.5, 14.221817970275879, 74.46641540527344, 48.5, 179.5, 75.03094482421875, 213.0, 177.375, 219.5, 213.5, 58.24647903442383, 177.4705810546875, 61.3337516784668, 182.0930938720703, 57.588077545166016, 183.22398376464844, 57.5, 14.5, 86.5, 73.0, 77.27535247802734, 187.5, 32.5, 183.0, 72.0, 182.0, 181.55999755859375, 183.0, 178.0, 185.051025390625, 182.8471221923828, 184.5, 9.0, 186.0, 4.0, 185.02487182617188, 186.38702392578125, 184.52272033691406, 112.0, 75.42276763916016, 186.23529052734375, 179.87864685058594, 184.5, 78.5, 55.5, 184.02272033691406, 67.05497741699219, 185.5, 187.164306640625, 190.48805236816406, 213.5, 187.448974609375, 187.5, 220.0, 190.5, 50.0, 112.0, 9.5, 186.0, 14.5, 186.0, 185.92393493652344, 184.64999389648438, 197.5, 185.29136657714844, 75.0, 189.0, 187.5, 78.0, 57.0, 112.0, 185.60934448242188, 202.0, 131.5, 186.57113647460938, 186.5, 196.0, 172.5, 112.5, 192.0, 178.0, 76.140625]';

y=-y;

c = [x,y];

eva = evalclusters(c,'kmeans','DaviesBouldin','KList',[1:10])


for i=1:eva.OptimalK
    if sum(eva.OptimalY==i)>15
        scatter(c(eva.OptimalY==i,1),c(eva.OptimalY==i,2)); hold on;
        xlim = [0 255]
        ylim = [0 -255]
    end
end

